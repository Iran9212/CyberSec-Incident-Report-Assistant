app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: workflow
  name: CyberSec Incident Report Assistant
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/gemini:0.2.3@1f549adb04dae791e36f4dac3edb5d128a381ed7da3e05c1b3734274e5bf01d6
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: bowenliang123/md_exporter:1.4.100@71e015c278af8ae41b80f88a72f03ef92ad01b8db0c3676eafd3f998c4d57601
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: code
      id: 1748335463589-source-1748523699627-target
      selected: false
      source: '1748335463589'
      sourceHandle: source
      target: '1748523699627'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1748523699627-source-1748523800444-target
      selected: false
      source: '1748523699627'
      sourceHandle: source
      target: '1748523800444'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1748523800444-source-1748524099318-target
      selected: false
      source: '1748523800444'
      sourceHandle: source
      target: '1748524099318'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1748524099318-source-1748524167370-target
      selected: false
      source: '1748524099318'
      sourceHandle: source
      target: '1748524167370'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: tool
      id: 1748524167370-source-1748689056509-target
      source: '1748524167370'
      sourceHandle: source
      target: '1748689056509'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: end
      id: 1748689056509-source-1748526218645-target
      source: '1748689056509'
      sourceHandle: source
      target: '1748526218645'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: Start
        type: start
        variables:
        - allowed_file_extensions: []
          allowed_file_types:
          - document
          allowed_file_upload_methods:
          - local_file
          - remote_url
          label: æ—¥èªŒæª”æ¡ˆ
          max_length: 1
          options: []
          required: true
          type: file-list
          variable: log_file
        - label: åˆ†æé‡é»
          max_length: 48
          options:
          - å…¨é¢åˆ†æ
          - æƒ¡æ„è»Ÿé«”æª¢æ¸¬
          - ç¶²è·¯å…¥ä¾µ
          - ç•°å¸¸ç™»å…¥
          - è³‡æ–™å¤–æ´©
          - ç³»çµ±ç•°å¸¸
          required: false
          type: select
          variable: analysis_focus
        - label: æ™‚é–“ç¯„åœç¯©é¸
          max_length: 48
          options: []
          required: false
          type: text-input
          variable: time_range
        - label: å ±å‘Šåš´é‡ç¨‹åº¦
          max_length: 48
          options:
          - Low
          - Medium
          - High
          - Critical
          - auto
          required: false
          type: select
          variable: severity
        - label: å ±å‘Šèªè¨€
          max_length: 48
          options:
          - zh-TW
          - zh-CN
          - en-US
          required: false
          type: select
          variable: report_language
        - label: åŒ…å«æ”¹å–„å»ºè­°
          max_length: 48
          options:
          - 'True'
          - 'False'
          required: false
          type: select
          variable: include_recommendations
      height: 220
      id: '1748335463589'
      position:
        x: 15.826992942018705
        y: 264.597150628344
      positionAbsolute:
        x: 15.826992942018705
        y: 264.597150628344
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\nimport hashlib\nimport re\nfrom datetime import datetime,\
          \ timedelta\nfrom collections import Counter\n\ndef main(log_file, analysis_focus=\"\
          comprehensive\", time_range=\"\", severity=\"auto\", report_language=\"\
          zh-TW\", include_recommendations=True):\n    \"\"\"\n    è™•ç†ä¸Šå‚³çš„æ—¥èªŒæª”æ¡ˆä¸¦é€²è¡Œåˆæ­¥åˆ†æ\n\
          \    \"\"\"\n    try:\n        # è®€å–æ—¥èªŒæª”æ¡ˆå…§å®¹\n        log_content = read_log_file(log_file)\n\
          \        \n        # è§£ææ—¥èªŒå…§å®¹\n        parsed_logs = parse_log_entries(log_content)\n\
          \        \n        # æ™‚é–“ç¯„åœç¯©é¸\n        if time_range:\n            parsed_logs\
          \ = filter_by_time_range(parsed_logs, time_range)\n        \n        # å®‰å…¨äº‹ä»¶æª¢æ¸¬\n\
          \        security_events = detect_security_events(parsed_logs, analysis_focus)\n\
          \        \n        # çµ±è¨ˆåˆ†æ\n        statistics = generate_statistics(security_events,\
          \ parsed_logs)\n        \n        # åš´é‡ç¨‹åº¦è©•ä¼°\n        if severity == \"auto\"\
          :\n            assessed_severity = assess_severity(security_events)\n  \
          \      else:\n            assessed_severity = severity\n        \n     \
          \   # ç”Ÿæˆè™•ç†çµæœ\n        processed_data = {\n            \"analysis_id\": generate_analysis_id(log_file.get('name',\
          \ 'unknown')),\n            \"file_info\": {\n                \"filename\"\
          : log_file.get('name', 'unknown.log'),\n                \"size\": log_file.get('size',\
          \ 0),\n                \"upload_time\": datetime.now().isoformat()\n   \
          \         },\n            \"analysis_config\": {\n                \"focus\"\
          : analysis_focus,\n                \"time_range\": time_range,\n       \
          \         \"language\": report_language,\n                \"include_recommendations\"\
          : include_recommendations\n            },\n            \"log_summary\":\
          \ {\n                \"total_entries\": len(parsed_logs),\n            \
          \    \"time_span\": get_time_span(parsed_logs),\n                \"unique_sources\"\
          : len(set([log.get('source', 'unknown') for log in parsed_logs]))\n    \
          \        },\n            \"security_events\": security_events,\n       \
          \     \"statistics\": statistics,\n            \"severity\": assessed_severity,\n\
          \            \"processing_time\": datetime.now().isoformat(),\n        \
          \    \"keywords\": extract_security_keywords(log_content)\n        }\n \
          \       \n        return {\n            \"processed_event\": json.dumps(processed_data,\
          \ ensure_ascii=False, indent=2)\n        }\n        \n    except Exception\
          \ as e:\n        return {\n            \"processed_event\": json.dumps({\n\
          \                \"error\": f\"æ—¥èªŒè™•ç†éŒ¯èª¤: {str(e)}\",\n                \"analysis_id\"\
          : \"ERROR\",\n                \"file_info\": {\"filename\": \"error.log\"\
          },\n                \"severity\": \"High\",\n                \"processing_time\"\
          : datetime.now().isoformat()\n            }, ensure_ascii=False, indent=2)\n\
          \        }\n\ndef read_log_file(log_file):\n    \"\"\"è®€å–æ—¥èªŒæª”æ¡ˆå…§å®¹\"\"\"\n \
          \   # åœ¨å¯¦éš› Dify ç’°å¢ƒä¸­ï¼Œé€™è£¡æœƒä½¿ç”¨ window.fs.readFile\n    # æ­¤è™•æä¾›ç¤ºä¾‹è™•ç†é‚è¼¯\n    if isinstance(log_file,\
          \ dict) and 'content' in log_file:\n        return log_file['content']\n\
          \    elif isinstance(log_file, str):\n        return log_file\n    else:\n\
          \        # ä½¿ç”¨ Dify çš„æª”æ¡ˆè®€å– API\n        return str(log_file)\n\ndef parse_log_entries(log_content):\n\
          \    \"\"\"è§£ææ—¥èªŒæ¢ç›®\"\"\"\n    entries = []\n    lines = log_content.split('\\\
          n')\n    \n    for line in lines:\n        if line.strip():\n          \
          \  entry = parse_single_log_entry(line)\n            if entry:\n       \
          \         entries.append(entry)\n    \n    return entries\n\ndef parse_single_log_entry(line):\n\
          \    \"\"\"è§£æå–®ä¸€æ—¥èªŒæ¢ç›®\"\"\"\n    # å¸¸è¦‹æ—¥èªŒæ ¼å¼æ¨¡å¼\n    patterns = [\n        # Apache/Nginx\
          \ æ ¼å¼\n        r'(?P<ip>\\d+\\.\\d+\\.\\d+\\.\\d+).*\\[(?P<timestamp>[^\\\
          ]]+)\\].*\"(?P<method>\\w+)\\s+(?P<url>[^\"]*)\".*(?P<status>\\d+)',\n \
          \       # Windows Event Log æ ¼å¼\n        r'(?P<timestamp>\\d{4}[-/]\\d{2}[-/]\\\
          d{2}\\s+\\d{2}:\\d{2}:\\d{2}).*(?P<level>INFO|WARN|ERROR|DEBUG).*(?P<message>.*)',\n\
          \        # Syslog æ ¼å¼\n        r'(?P<timestamp>\\w{3}\\s+\\d{1,2}\\s+\\d{2}:\\\
          d{2}:\\d{2})\\s+(?P<host>\\S+)\\s+(?P<process>\\S+):\\s*(?P<message>.*)',\n\
          \        # ä¸€èˆ¬æ ¼å¼\n        r'(?P<timestamp>\\d{4}-\\d{2}-\\d{2}\\s+\\d{2}:\\\
          d{2}:\\d{2}).*(?P<message>.*)'\n    ]\n    \n    for pattern in patterns:\n\
          \        match = re.search(pattern, line)\n        if match:\n         \
          \   return {\n                'raw_line': line,\n                'timestamp':\
          \ match.groupdict().get('timestamp', ''),\n                'ip': match.groupdict().get('ip',\
          \ ''),\n                'method': match.groupdict().get('method', ''),\n\
          \                'url': match.groupdict().get('url', ''),\n            \
          \    'status': match.groupdict().get('status', ''),\n                'level':\
          \ match.groupdict().get('level', ''),\n                'host': match.groupdict().get('host',\
          \ ''),\n                'process': match.groupdict().get('process', ''),\n\
          \                'message': match.groupdict().get('message', line),\n  \
          \              'source': 'parsed'\n            }\n    \n    # å¦‚æœç„¡æ³•è§£æï¼Œè¿”å›åŸå§‹è³‡æ–™\n\
          \    return {\n        'raw_line': line,\n        'message': line,\n   \
          \     'source': 'raw'\n    }\n\ndef detect_security_events(logs, focus):\n\
          \    \"\"\"æª¢æ¸¬å®‰å…¨äº‹ä»¶\"\"\"\n    events = []\n    \n    # å®šç¾©ä¸åŒé¡å‹çš„æª¢æ¸¬è¦å‰‡\n    detection_rules\
          \ = {\n        'malware': [\n            r'virus|malware|trojan|ransomware|backdoor',\n\
          \            r'suspicious.*exe|\\.bat|\\.ps1',\n            r'blocked.*file|quarantine'\n\
          \        ],\n        'network_intrusion': [\n            r'failed.*login|authentication.*failed',\n\
          \            r'brute.*force|dictionary.*attack',\n            r'port.*scan|vulnerability.*scan',\n\
          \            r'ddos|dos.*attack'\n        ],\n        'suspicious_login':\
          \ [\n            r'login.*fail|logon.*fail',\n            r'invalid.*user|unknown.*user',\n\
          \            r'multiple.*fail|repeated.*fail',\n            r'admin.*login|root.*login'\n\
          \        ],\n        'data_exfiltration': [\n            r'large.*transfer|bulk.*download',\n\
          \            r'database.*export|backup.*download',\n            r'unusual.*traffic|abnormal.*data'\n\
          \        ],\n        'system_anomaly': [\n            r'system.*error|critical.*error',\n\
          \            r'service.*stop|process.*crash',\n            r'disk.*full|memory.*leak'\n\
          \        ]\n    }\n    \n    # æ ¹æ“šåˆ†æé‡é»é¸æ“‡è¦å‰‡\n    if focus == \"comprehensive\"\
          :\n        active_rules = {k: v for k, v in detection_rules.items()}\n \
          \   else:\n        active_rules = {focus: detection_rules.get(focus, [])}\n\
          \    \n    # æª¢æ¸¬äº‹ä»¶\n    for log in logs:\n        message = log.get('message',\
          \ '').lower()\n        for event_type, rules in active_rules.items():\n\
          \            for rule in rules:\n                if re.search(rule, message,\
          \ re.IGNORECASE):\n                    events.append({\n               \
          \         'type': event_type,\n                        'timestamp': log.get('timestamp',\
          \ ''),\n                        'source': log.get('ip', log.get('host',\
          \ 'unknown')),\n                        'message': log.get('message', ''),\n\
          \                        'rule_matched': rule,\n                       \
          \ 'raw_log': log.get('raw_line', '')\n                    })\n    \n   \
          \ return events\n\ndef generate_statistics(events, logs):\n    \"\"\"ç”Ÿæˆçµ±è¨ˆè³‡æ–™\"\
          \"\"\n    return {\n        'event_types': dict(Counter([e['type'] for e\
          \ in events])),\n        'source_ips': dict(Counter([e['source'] for e in\
          \ events]).most_common(10)),\n        'hourly_distribution': generate_hourly_stats(events),\n\
          \        'top_rules': dict(Counter([e['rule_matched'] for e in events]).most_common(5))\n\
          \    }\n\ndef generate_hourly_stats(events):\n    \"\"\"ç”Ÿæˆæ¯å°æ™‚çµ±è¨ˆ\"\"\"\n\
          \    hourly = {}\n    for event in events:\n        timestamp = event.get('timestamp',\
          \ '')\n        if timestamp:\n            try:\n                hour = timestamp.split('\
          \ ')[1].split(':')[0] if ' ' in timestamp else '00'\n                hourly[hour]\
          \ = hourly.get(hour, 0) + 1\n            except:\n                pass\n\
          \    return hourly\n\ndef assess_severity(events):\n    \"\"\"è©•ä¼°åš´é‡ç¨‹åº¦\"\"\
          \"\n    if not events:\n        return \"Low\"\n    \n    critical_keywords\
          \ = ['virus', 'malware', 'ransomware', 'data exfiltration', 'admin login']\n\
          \    high_keywords = ['brute force', 'failed login', 'port scan', 'ddos']\n\
          \    \n    event_count = len(events)\n    critical_events = sum(1 for e\
          \ in events if any(kw in e['message'].lower() for kw in critical_keywords))\n\
          \    high_events = sum(1 for e in events if any(kw in e['message'].lower()\
          \ for kw in high_keywords))\n    \n    if critical_events > 0 or event_count\
          \ > 100:\n        return \"Critical\"\n    elif high_events > 10 or event_count\
          \ > 50:\n        return \"High\"\n    elif event_count > 10:\n        return\
          \ \"Medium\"\n    else:\n        return \"Low\"\n\ndef extract_security_keywords(content):\n\
          \    \"\"\"æå–å®‰å…¨é—œéµå­—\"\"\"\n    keywords = [\n        'malware', 'virus',\
          \ 'trojan', 'ransomware', 'phishing', 'ddos',\n        'sql injection',\
          \ 'xss', 'brute force', 'port scan', 'login fail',\n        'authentication',\
          \ 'unauthorized', 'suspicious', 'blocked', 'quarantine'\n    ]\n    \n \
          \   found = []\n    content_lower = content.lower()\n    for keyword in\
          \ keywords:\n        if keyword in content_lower:\n            found.append(keyword)\n\
          \    \n    return found\n\ndef generate_analysis_id(filename):\n    \"\"\
          \"ç”Ÿæˆåˆ†æ ID\"\"\"\n    hash_obj = hashlib.md5(f\"{filename}{datetime.now()}\"\
          .encode('utf-8'))\n    return f\"LOG-{datetime.now().strftime('%Y%m%d')}-{hash_obj.hexdigest()[:8].upper()}\"\
          \n\ndef filter_by_time_range(logs, time_range):\n    \"\"\"æ ¹æ“šæ™‚é–“ç¯„åœç¯©é¸æ—¥èªŒ\"\"\
          \"\n    # ç°¡åŒ–å¯¦ç¾ï¼Œå¯¦éš›å¯ä»¥æ›´è¤‡é›œ\n    return logs\n\ndef get_time_span(logs):\n  \
          \  \"\"\"ç²å–æ—¥èªŒæ™‚é–“è·¨åº¦\"\"\"\n    if not logs:\n        return \"ç„¡æ³•ç¢ºå®š\"\n   \
          \ \n    timestamps = [log.get('timestamp', '') for log in logs if log.get('timestamp')]\n\
          \    if timestamps:\n        return f\"å¾ {min(timestamps)} åˆ° {max(timestamps)}\"\
          \n    return \"ç„¡æ³•ç¢ºå®š\""
        code_language: python3
        desc: è³‡æ–™é è™•ç†
        outputs:
          processed_event:
            children: null
            type: string
        selected: false
        title: Code
        type: code
        variables:
        - value_selector:
          - '1748335463589'
          - log_file
          variable: log_file
        - value_selector:
          - '1748335463589'
          - analysis_focus
          variable: analysis_focus
        - value_selector:
          - '1748335463589'
          - time_range
          variable: time_range
        - value_selector:
          - '1748335463589'
          - severity
          variable: severity
        - value_selector:
          - '1748335463589'
          - report_language
          variable: report_language
        - value_selector:
          - '1748335463589'
          - include_recommendations
          variable: include_recommendations
      height: 82
      id: '1748523699627'
      position:
        x: 318.8269929420187
        y: 264.597150628344
      positionAbsolute:
        x: 318.8269929420187
        y: 264.597150628344
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1748523699627'
          - processed_event
        desc: å¨è„…åˆ†æ
        model:
          completion_params: {}
          mode: chat
          name: gemini-2.0-flash
          provider: langgenius/gemini/google
        prompt_template:
        - id: 8f4ed0cb-2fb3-4305-affe-14ba5c104a44
          role: system
          text: "ä½ æ˜¯è³‡æ·±çš„è³‡å®‰åˆ†æå¸«ï¼Œæ“æœ‰è±å¯Œçš„å¨è„…çµæ•å’Œäº‹ä»¶å›æ‡‰ç¶“é©—ã€‚ä½ çš„ä»»å‹™æ˜¯åˆ†æè³‡å®‰äº‹ä»¶ä¸¦æä¾›å°ˆæ¥­çš„å¨è„…è©•ä¼°ã€‚ \n\nåˆ†ææ™‚è«‹è€ƒæ…®ï¼š \n\
            1. æ”»æ“Šè€…çš„å¯èƒ½å‹•æ©Ÿå’Œç›®æ¨™ \n2. æ”»æ“Šçš„æŠ€è¡“è¤‡é›œåº¦ \n3. æ½›åœ¨çš„æ¥­å‹™å½±éŸ¿ \n4. æ”»æ“Šçš„æ™‚é–“è»¸å’ŒæŒçºŒæ€§ \n5. ç›¸é—œçš„å¨è„…æƒ…å ±\
            \ \n\nè«‹ä»¥å®¢è§€ã€å°ˆæ¥­çš„è§’åº¦é€²è¡Œåˆ†æï¼Œé¿å…éåº¦è§£è®€æˆ–è‡†æ¸¬ã€‚"
        - id: cd539f45-4df0-442d-8854-a5c189a4551e
          role: user
          text: "è«‹åˆ†æä»¥ä¸‹è³‡å®‰äº‹ä»¶ä¸¦æä¾›è©³ç´°çš„å¨è„…è©•ä¼°ï¼š\n\näº‹ä»¶è©³æƒ…ï¼š\n{{#1748523699627.processed_event#}}\n\
            \nè«‹æä¾›ä»¥ä¸‹åˆ†æï¼Œä¸¦ä»¥ JSON æ ¼å¼å›æ‡‰ï¼š\n\n{\n  \"threat_analysis\": {\n    \"threat_type\"\
            : \"å…·é«”çš„å¨è„…é¡å‹\",\n    \"attack_category\": \"æ”»æ“Šåˆ†é¡ (ä¾‹å¦‚: APT, ç¶²è·¯çŠ¯ç½ª, å…§éƒ¨å¨è„…ç­‰)\"\
            ,\n    \"sophistication_level\": \"æŠ€è¡“è¤‡é›œåº¦ (ä½/ä¸­/é«˜/APTç´šåˆ¥)\",\n    \"threat_actor_profile\"\
            : \"å¯èƒ½çš„æ”»æ“Šè€…è¼ªå»“\",\n    \"attack_vectors\": [\"ä¸»è¦æ”»æ“Šå‘é‡1\", \"ä¸»è¦æ”»æ“Šå‘é‡2\"],\n\
            \    \"attack_objectives\": [\"å¯èƒ½çš„æ”»æ“Šç›®æ¨™1\", \"å¯èƒ½çš„æ”»æ“Šç›®æ¨™2\"],\n    \"persistence_methods\"\
            : [\"æŒä¹…åŒ–æ–¹æ³•1\", \"æŒä¹…åŒ–æ–¹æ³•2\"],\n    \"data_at_risk\": [\"å¯èƒ½å—å½±éŸ¿çš„è³‡æ–™é¡å‹\"],\n\
            \    \"business_impact\": {\n      \"confidentiality\": \"æ©Ÿå¯†æ€§å½±éŸ¿è©•ä¼°\",\n\
            \      \"integrity\": \"å®Œæ•´æ€§å½±éŸ¿è©•ä¼°\", \n      \"availability\": \"å¯ç”¨æ€§å½±éŸ¿è©•ä¼°\"\
            ,\n      \"financial_impact\": \"æ½›åœ¨è²¡å‹™å½±éŸ¿\",\n      \"reputation_impact\"\
            : \"è²è­½å½±éŸ¿è©•ä¼°\"\n    },\n    \"urgency_level\": \"è™•ç†ç·Šæ€¥ç¨‹åº¦ (1-5, 5æœ€ç·Šæ€¥)\",\n\
            \    \"recommended_actions\": [\"ç«‹å³è™•ç½®å»ºè­°1\", \"ç«‹å³è™•ç½®å»ºè­°2\"],\n    \"investigation_priorities\"\
            : [\"èª¿æŸ¥é‡é»1\", \"èª¿æŸ¥é‡é»2\"]\n  }\n}\n\nè«‹ç¢ºä¿åˆ†æåŸºæ–¼äº‹å¯¦ï¼Œé¿å…éåº¦æ¨æ¸¬ã€‚å¦‚æœè³‡è¨Šä¸è¶³ï¼Œè«‹æ˜ç¢ºæ¨™è¨»ã€Œéœ€è¦æ›´å¤šè³‡è¨Šã€ã€‚"
        selected: false
        title: LLM
        type: llm
        variables: []
        vision:
          enabled: false
      height: 118
      id: '1748523800444'
      position:
        x: 621.8269929420187
        y: 264.597150628344
      positionAbsolute:
        x: 621.8269929420187
        y: 264.597150628344
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: MITRE ATT&CK å°æ‡‰
        model:
          completion_params: {}
          mode: chat
          name: gemini-2.0-flash
          provider: langgenius/gemini/google
        prompt_template:
        - id: 0001feef-555a-4d3c-b0e6-7334fbf62b14
          role: system
          text: 'ä½ æ˜¯ MITRE ATT&CK æ¡†æ¶å°ˆå®¶ï¼Œç†Ÿæ‚‰æ‰€æœ‰çš„æˆ°è¡“ (Tactics)ã€æŠ€è¡“ (Techniques) å’Œå­æŠ€è¡“ (Sub-techniques)ã€‚


            è«‹æ ¹æ“šå¨è„…åˆ†æçµæœï¼Œæº–ç¢ºå°æ‡‰ç›¸é—œçš„ MITRE ATT&CK æŠ€è¡“ã€‚å°æ‡‰æ™‚è«‹ï¼š

            1. åªé¸æ“‡æœ€ç›¸é—œå’Œè­‰æ“šå……åˆ†çš„æŠ€è¡“

            2. æŒ‰ç…§æ”»æ“Šéˆçš„é †åºçµ„ç¹”æŠ€è¡“

            3. æä¾›æ¯å€‹æŠ€è¡“çš„ç°¡è¦èªªæ˜

            4. æ¨™è¨»ä¿¡å¿ƒåº¦ç­‰ç´š


            è«‹ä½¿ç”¨æœ€æ–°çš„ MITRE ATT&CK v14 æ¡†æ¶ã€‚'
        - id: a54b739d-1554-4237-aeff-7314bcbcded1
          role: user
          text: "åŸºæ–¼ä»¥ä¸‹å¨è„…åˆ†æçµæœï¼Œè«‹å°æ‡‰ç›¸é—œçš„ MITRE ATT&CK æŠ€è¡“ï¼š\n\nå¨è„…åˆ†æçµæœï¼š\n{{#å¨è„…åˆ†æ.text#}}\n\n\
            è«‹ä»¥ JSON æ ¼å¼æä¾› MITRE ATT&CK å°æ‡‰ï¼š\n\n{\n  \"mitre_mapping\": {\n    \"attack_chain_summary\"\
            : \"æ”»æ“Šéˆæ•´é«”æè¿°\",\n    \"kill_chain_phases\": [\n      {\n        \"phase\"\
            : \"éšæ®µåç¨±\",\n        \"description\": \"éšæ®µæè¿°\",\n        \"techniques\"\
            : [\"T1234\", \"T5678\"]\n      }\n    ],\n    \"techniques\": [\n   \
            \   {\n        \"id\": \"T1059\",\n        \"name\": \"Command and Scripting\
            \ Interpreter\",\n        \"tactic\": \"Execution\",\n        \"sub_techniques\"\
            : [\n          {\n            \"id\": \"T1059.001\",\n            \"name\"\
            : \"PowerShell\",\n            \"confidence\": \"High\",\n           \
            \ \"evidence\": \"äº‹ä»¶ä¸­çš„å…·é«”è­‰æ“š\"\n          }\n        ],\n        \"confidence\"\
            : \"High\",\n        \"evidence_summary\": \"æ”¯æŒæ­¤æŠ€è¡“çš„è­‰æ“šæ‘˜è¦\",\n        \"\
            detection_methods\": [\"æª¢æ¸¬æ–¹æ³•1\", \"æª¢æ¸¬æ–¹æ³•2\"],\n        \"mitigation_references\"\
            : [\"M1038\", \"M1049\"]\n      }\n    ],\n    \"tactics_timeline\": [\n\
            \      {\n        \"order\": 1,\n        \"tactic\": \"Initial Access\"\
            ,\n        \"techniques\": [\"T1566.001\"],\n        \"estimated_time\"\
            : \"æ”»æ“Šé–‹å§‹æ™‚é–“æˆ–éšæ®µ\"\n      }\n    ],\n    \"confidence_assessment\": {\n \
            \     \"overall_confidence\": \"Medium\",\n      \"reasoning\": \"ä¿¡å¿ƒåº¦è©•ä¼°çš„åŸå› \"\
            \n    }\n  }\n}\n\nè«‹ç¢ºä¿ï¼š\n1. åªåŒ…å«æœ‰è¶³å¤ è­‰æ“šæ”¯æŒçš„æŠ€è¡“\n2. æŠ€è¡“ ID å’Œåç¨±æº–ç¢ºç„¡èª¤\n3. ä¿¡å¿ƒåº¦è©•ä¼°åˆç†\n\
            4. æä¾›å…·é«”çš„æª¢æ¸¬å’Œç·©è§£å»ºè­°"
        selected: false
        title: LLM 2
        type: llm
        variables: []
        vision:
          enabled: false
      height: 118
      id: '1748524099318'
      position:
        x: 924.8269929420187
        y: 264.597150628344
      positionAbsolute:
        x: 924.8269929420187
        y: 264.597150628344
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: true
          variable_selector:
          - '1748524099318'
          - text
        desc: å ±å‘Šç”Ÿæˆ
        model:
          completion_params: {}
          mode: chat
          name: gemini-2.0-flash
          provider: langgenius/gemini/google
        prompt_template:
        - id: d17793ff-f87a-4c2c-83ef-8b8e34093288
          role: system
          text: 'ä½ æ˜¯å°ˆæ¥­çš„è³‡å®‰å ±å‘Šæ’°å¯«å°ˆå®¶ï¼Œèƒ½å¤ ç”¢å‡ºç¬¦åˆæ¥­ç•Œæ¨™æº–çš„è³‡å®‰åˆ†æå ±å‘Šã€‚


            å ±å‘Šæ’°å¯«åŸå‰‡ï¼š

            1. çµæ§‹æ¸…æ™°ã€é‚è¼¯åš´è¬¹

            2. æŠ€è¡“å…§å®¹æº–ç¢ºã€æ˜“æ‡‚

            3. å»ºè­°å…·é«”ã€å¯åŸ·è¡Œ

            4. ç¬¦åˆåˆè¦è¦æ±‚

            5. é©åˆä¸åŒæŠ€è¡“å±¤ç´šçš„è®€è€…


            è«‹æ ¹æ“šæŒ‡å®šèªè¨€æ’°å¯«å ±å‘Šï¼Œç¢ºä¿å°ˆæ¥­è¡“èªä½¿ç”¨æ­£ç¢ºã€‚'
        - id: 826d1613-45b1-4c2c-bf9e-7c3b1fb3269b
          role: user
          text: 'è«‹æ ¹æ“šä»¥ä¸‹åˆ†æçµæœç”Ÿæˆå®Œæ•´çš„è³‡å®‰äº‹ä»¶åˆ†æå ±å‘Šï¼š


            åŸå§‹äº‹ä»¶è³‡æ–™ï¼š

            {{#1748523699627.processed_event#}}


            å¨è„…åˆ†æï¼š

            {{#1748523800444.text#}}


            MITRE ATT&CK å°æ‡‰ï¼š

            {{#1748524099318.text#}}


            å ±å‘Šè¦æ±‚ï¼š

            - èªè¨€ï¼šæ ¹æ“š processed_event ä¸­çš„ language è¨­å®š

            - æ ¼å¼ï¼šMarkdown

            - é•·åº¦ï¼šå®Œæ•´è©³ç´°çš„å°ˆæ¥­å ±å‘Š

            - å—çœ¾ï¼šè³‡å®‰åœ˜éšŠã€ç®¡ç†å±¤ã€åˆè¦éƒ¨é–€


            å ±å‘Šçµæ§‹ï¼š


            # è³‡å®‰äº‹ä»¶åˆ†æå ±å‘Š


            ## åŸ·è¡Œæ‘˜è¦

            [ç°¡æ½”çš„äº‹ä»¶æ¦‚è¿°ã€é¢¨éšªè©•ç´šã€é—œéµç™¼ç¾å’Œå»ºè­°]


            ## äº‹ä»¶åŸºæœ¬è³‡è¨Š

            - äº‹ä»¶ IDï¼š

            - ç™¼ç”Ÿæ™‚é–“ï¼š

            - äº‹ä»¶ä¾†æºï¼š

            - åš´é‡ç¨‹åº¦ï¼š

            - åˆ†ææ™‚é–“ï¼š


            ## äº‹ä»¶æè¿°

            [è©³ç´°çš„äº‹ä»¶æè¿°å’Œæ™‚é–“è»¸]


            ## å¨è„…åˆ†æ

            ### æ”»æ“Šæ€§è³ª

            [å¨è„…é¡å‹ã€æ”»æ“Šè€…è¼ªå»“ã€æ”»æ“Šç›®æ¨™]


            ### æ”»æ“ŠæŠ€è¡“åˆ†æ

            [å…·é«”çš„æ”»æ“Šæ–¹æ³•å’ŒæŠ€è¡“ç´°ç¯€]


            ### å½±éŸ¿è©•ä¼°

            [å°æ©Ÿå¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§çš„å½±éŸ¿]


            ## MITRE ATT&CK æ¡†æ¶åˆ†æ

            ### æ”»æ“Šéˆåˆ†æ

            [å®Œæ•´çš„æ”»æ“Šéˆæè¿°]


            ### æŠ€è¡“å°æ‡‰è¡¨

            [è¡¨æ ¼å½¢å¼å‘ˆç¾ MITRE æŠ€è¡“å°æ‡‰]


            ### æˆ°è¡“æ™‚é–“è»¸

            [æ”»æ“Šå„éšæ®µçš„æ™‚é–“è»¸]


            ## é¢¨éšªè©•ä¼°

            ### æ¥­å‹™é¢¨éšª

            [è²¡å‹™ã€ç‡Ÿé‹ã€è²è­½ç­‰é¢¨éšª]


            ### æŠ€è¡“é¢¨éšª

            [ç³»çµ±ã€è³‡æ–™ã€ç¶²è·¯ç­‰é¢¨éšª]


            ## è™•ç½®å»ºè­°

            ### ç«‹å³è¡Œå‹• (0-24å°æ™‚)

            [ç·Šæ€¥è™•ç½®æ­¥é©Ÿ]


            ### çŸ­æœŸè¡Œå‹• (1-7å¤©)

            [çŸ­æœŸæ”¹å–„æªæ–½]


            ### é•·æœŸè¡Œå‹• (1-3å€‹æœˆ)

            [é•·æœŸå®‰å…¨å¼·åŒ–]


            ## æª¢æ¸¬èˆ‡ç›£æ§å»ºè­°

            [æ”¹å–„æª¢æ¸¬èƒ½åŠ›çš„å…·é«”å»ºè­°]


            ## é é˜²æªæ–½

            [é˜²æ­¢é¡ä¼¼äº‹ä»¶çš„å…·é«”æªæ–½]


            ## åˆè¦è€ƒé‡

            [ç›¸é—œæ³•è¦å’Œæ¨™æº–çš„åˆè¦è¦æ±‚]


            ## é™„éŒ„

            ### æŠ€è¡“ç´°ç¯€

            [è©³ç´°çš„æŠ€è¡“è³‡è¨Š]


            ### åƒè€ƒè³‡æ–™

            [MITRE ATT&CK é€£çµã€ç›¸é—œè³‡æº]


            ### è¯çµ¡è³‡è¨Š

            [å¾ŒçºŒè¯çµ¡å’Œæ”¯æ´è³‡è¨Š]


            è«‹ç¢ºä¿å ±å‘Šå°ˆæ¥­ã€å®Œæ•´ä¸”æ˜“æ–¼ç†è§£ã€‚'
        selected: false
        title: LLM 3
        type: llm
        variables: []
        vision:
          enabled: false
      height: 118
      id: '1748524167370'
      position:
        x: 1227.8269929420187
        y: 264.597150628344
      positionAbsolute:
        x: 1227.8269929420187
        y: 264.597150628344
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1748524167370'
          - text
          variable: text
        - value_selector:
          - '1748526160082'
          - result
          variable: result
        - value_selector:
          - '1748523699627'
          - processed_event
          variable: processed_event
        - value_selector:
          - '1748689056509'
          - files
          variable: files
        selected: false
        title: End
        type: end
      height: 168
      id: '1748526218645'
      position:
        x: 1828.8269929420187
        y: 264.597150628344
      positionAbsolute:
        x: 1828.8269929420187
        y: 264.597150628344
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        default_value:
        - key: text
          type: string
          value: ''
        - key: json
          type: array[object]
          value: '[]'
        desc: ''
        error_strategy: default-value
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Markdown text
            ja_JP: Markdown text
            pt_BR: Markdown text
            zh_Hans: Markdownæ ¼å¼æ–‡æœ¬
          label:
            en_US: Markdown text
            ja_JP: Markdown text
            pt_BR: Markdown text
            zh_Hans: Markdownæ ¼å¼æ–‡æœ¬
          llm_description: ''
          max: null
          min: null
          name: md_text
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Filename of the output file
            ja_JP: Filename of the output file
            pt_BR: Filename of the output file
            zh_Hans: è¾“å‡ºæ–‡ä»¶å
          label:
            en_US: Filename of the output file
            ja_JP: Filename of the output file
            pt_BR: Filename of the output file
            zh_Hans: è¾“å‡ºæ–‡ä»¶å
          llm_description: ''
          max: null
          min: null
          name: output_filename
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        params:
          md_text: ''
          output_filename: ''
        provider_id: bowenliang123/md_exporter/md_exporter
        provider_name: bowenliang123/md_exporter/md_exporter
        provider_type: builtin
        retry_config:
          max_retries: 3
          retry_enabled: false
          retry_interval: 1000
        selected: false
        title: Markdown to PDF file
        tool_configurations: {}
        tool_description: A tool for generating PDF file from Markdown text
        tool_label: Markdown to PDF file
        tool_name: md_to_pdf
        tool_parameters:
          md_text:
            type: mixed
            value: '{{#1748524167370.text#}}'
          output_filename:
            type: mixed
            value: è³‡å®‰åˆ†æå ±å‘Š
        type: tool
      height: 90
      id: '1748689056509'
      position:
        x: 1531.8269929420187
        y: 264.597150628344
      positionAbsolute:
        x: 1531.8269929420187
        y: 264.597150628344
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 0.2557063521845748
      y: 97.76256443449063
      zoom: 0.8999999999999992
